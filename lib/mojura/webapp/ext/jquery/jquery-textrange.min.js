(function(e){var t,n={get:function(e){return r[t].get.apply(this,[e])},set:function(e,n){var i=parseInt(e),s=parseInt(n),o;if(typeof e==="undefined"){i=0}else if(e<0){i=this.val().length+i}if(typeof n==="undefined"){o=this.val().length}else if(n>=0){o=i+s}else{o=this.val().length+s}r[t].set.apply(this,[i,o]);return this},setcursor:function(e){return this.textrange("set",e,0)},replace:function(e){r[t].replace.apply(this,[e]);return this},insert:function(e){return this.textrange("replace",e)}},r={xul:{get:function(e){this[0].focus();var t={position:this[0].selectionStart,start:this[0].selectionStart,end:this[0].selectionEnd,length:this[0].selectionEnd-this[0].selectionStart,text:this.val().substring(this[0].selectionStart,this[0].selectionEnd)};return typeof e==="undefined"?t:t[e]},set:function(e,t){this[0].focus();this[0].selectionStart=e;this[0].selectionEnd=t},replace:function(e){this[0].focus();var t=this[0].selectionStart;this.val(this.val().substring(0,this[0].selectionStart)+e+this.val().substring(this[0].selectionEnd,this.val().length));this[0].selectionStart=t;this[0].selectionEnd=t+e.length}},msie:{get:function(e){this[0].focus();var t=document.selection.createRange();if(typeof t==="undefined"){return{position:0,start:0,end:this[0].val().length,length:this[0].val().length,text:this.val()}}var n=this[0].createTextRange();var r=n.duplicate();n.moveToBookmark(t.getBookmark());r.setEndPoint("EndToStart",n);return{position:r.text.length,start:r.text.length,end:r.text.length+t.text.length,length:t.text.length,text:t.text}},set:function(e,t){this[0].focus();var n=this[0].createTextRange();if(typeof n==="undefined"){return this}if(typeof e!=="undefined"){n.moveStart("character",e);n.collapse()}if(typeof t!=="undefined"){n.moveEnd("character",t-e)}n.select()},replace:function(e){this[0].focus();document.selection.createRange().text=e}}};e.fn.textrange=function(r){if(typeof t==="undefined"){t="selectionStart"in this[0]?"xul":document.selection?"msie":"unknown"}if(t==="unknown"){return this}if(typeof r==="undefined"||typeof r!=="string"){return n.get.apply(this)}else if(typeof n[r]==="function"){return n[r].apply(this,Array.prototype.slice.call(arguments,1))}else{e.error("Method "+r+" does not exist in jQuery.textrange")}}})(jQuery)