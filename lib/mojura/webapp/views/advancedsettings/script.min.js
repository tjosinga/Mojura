var AdvancedSettingsView=(function(g){function b(j){var i=g("#settings-row-"+j);return{category:i.attr("data-category"),level:i.attr("data-level"),key:i.attr("data-key"),value:g(".advanced-setting-value-text",i).html()}}function c(i){g(".settings-"+i+" > div").sort(function(m,k){var l=g(m).attr("data-key").toLowerCase();var j=g(k).attr("data-key").toLowerCase();return(l>j)?1:(l<j?-1:0)}).appendTo(".settings-"+i)}function f(i){Modal.create({title:Locale.str("advancedsettings","action_add"),btn_action:Locale.str("system","action_add"),oncreated:function(j){var l=g("#template-advancedsettings-add").html();var m={category:i,datatypes:["String","Number","Boolean"]};var k=Mustache.render(l,m);g(".modal-body","#"+j).html(k)},onsubmitted:function(j,m){var l=g("#template-advancedsettings-row").html();m.is_public=(m.level==="public");m.is_protected=(m.level==="protected");m.is_private=(m.level==="private");var k=Mustache.render(l,m);g(".settings-"+i).append(k);c(i);g("#"+j).modal("hide")}})}function a(j){var i=g("#settings-row-"+j);g(".advanced-settings-value-text, .settings-edit-btn, .settings-delete-btn",i).addClass("hidden");g(".advanced-settings-input, .advanced-settings-input, .settings-save-btn, .settings-cancel-btn",i).removeClass("hidden");g("input, select","#settings-row-"+j).val(g(".advanced-settings-value-text",i).html());i.on("submit",function(){e(j);return false})}function e(m){var l=g("#settings-row-"+m);var k=b(m);var j=g("input, select","#settings-row-"+m).val();var i="__api__/settings/"+k.category+"/"+k.key+"?_method=put";i+="&value="+encodeURIComponent(j);g.getJSON(i,function(){g(".advanced-settings-value-text",l).html(j);h(m)})}function h(i){g(".advanced-settings-input, .settings-save-btn, .settings-cancel-btn","#settings-row-"+i).addClass("hidden");g(".advanced-settings-value-text, .settings-edit-btn, .settings-delete-btn","#settings-row-"+i).removeClass("hidden")}function d(j){var i=b(j);Modal.create({title:Locale.str("advancedsettings","action_delete"),btn_action:Locale.str("system","action_delete"),btn_class:"btn-danger",oncreated:function(k){var l=g("#template-advancedsettings-delete").html();g(".modal-body","#"+k).html(Mustache.render(l,i))},onsubmitted:function(k,l){g("#"+k).modal("hide");g("#settings-row-"+j).remove()}})}return{sortCategoryKeys:c,showAdd:f,showEdit:a,edit:e,hideEdit:h,showDelete:d}})(jQuery);