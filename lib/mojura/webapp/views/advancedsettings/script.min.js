var AdvancedSettingsView=function(t){"use strict";function e(e){var n=t("#settings-row-"+e);return{category:n.attr("data-category"),level:n.attr("data-level"),key:n.attr("data-key"),value:t(".advanced-setting-value-text",n).html()}}function n(e){t(".settings-"+e+" > div").sort(function(e,n){var a=t(e).attr("data-key").toLowerCase();var s=t(n).attr("data-key").toLowerCase();return a>s?1:a<s?-1:0}).appendTo(".settings-"+e)}function a(e){Modal.create({title:Locale.str("advancedsettings","action_add"),btn_action:Locale.str("system","action_add"),oncreated:function(n){var a=t("#template-advancedsettings-add").html();var s={category:e,datatypes:["String","Number","Boolean"]};var d=Mustache.render(a,s);t(".modal-body","#"+n).html(d)},onsubmitted:function(a,s){var d=t("#template-advancedsettings-row").html();s.is_public=s.level==="public";s.is_protected=s.level==="protected";s.is_private=s.level==="private";var i=Mustache.render(d,s);t(".settings-"+e).append(i);n(e);t("#"+a).modal("hide")}})}function s(e){var n=t("#settings-row-"+e);t(".advanced-settings-value-text, .settings-edit-btn, .settings-delete-btn",n).addClass("hidden");t(".advanced-settings-input, .advanced-settings-input, .settings-save-btn, .settings-cancel-btn",n).removeClass("hidden");t("input, select","#settings-row-"+e).val(t(".advanced-settings-value-text",n).html());n.on("submit",function(){d(e);return false})}function d(n){var a=t("#settings-row-"+n);var s=e(n);var d=t("input, select","#settings-row-"+n).val();var o="__api__/settings/"+s.category+"/"+s.key+"?_method=put";o+="&value="+encodeURIComponent(d);t.getJSON(o,function(){t(".advanced-settings-value-text",a).html(d);i(n)})}function i(e){t(".advanced-settings-input, .settings-save-btn, .settings-cancel-btn","#settings-row-"+e).addClass("hidden");t(".advanced-settings-value-text, .settings-edit-btn, .settings-delete-btn","#settings-row-"+e).removeClass("hidden")}function o(n){var a=e(n);Modal.create({title:Locale.str("advancedsettings","action_delete"),btn_action:Locale.str("system","action_delete"),btn_class:"btn-danger",oncreated:function(e){var n=t("#template-advancedsettings-delete").html();t(".modal-body","#"+e).html(Mustache.render(n,a))},onsubmitted:function(e,a){t("#"+e).modal("hide");t("#settings-row-"+n).remove()}})}return{sortCategoryKeys:n,showAdd:a,showEdit:s,edit:d,hideEdit:i,showDelete:o}}(jQuery);