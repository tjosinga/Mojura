var NewsView=(function(e){e(document).ready(function(){Locale.ensureLoaded("system");Locale.ensureLoaded("news")});function d(){a("new")}function a(f){Modal.create({id:"newsAddEditModal",modal_large:true,title:Locale.str("news","edit"),oncreated:function(g,i){e("#"+g).modal("show");var h="__api__/news/"+f;e.getJSON(h,function(m){var l=e("#template-news-addedit").html();m=e.extend({},m,Locale.getViewsStrings(["system","news"]));m.method=(f==="new")?"post":"put";m.newsid=f;m.urid=UIDGenerator.get();m.simple_rights_visible=((m.rights.rights&4)>0);var k={"rights-controls":e("#template-rights-controls").html()};var j=Mustache.render(l,m,k);e(".modal-body","#"+g).html(j);i()});return true},onsubmitted:function(g,h){location.reload()}})}function b(f){Modal.create({id:"newsDeleteModal",btn_class:"btn-danger",btn_action:Locale.str("system","delete"),title:Locale.str("news","delete"),oncreated:function(g){e("#"+g).modal("show");var i=e("#template-news-delete").html();var j=Locale.getViewsStrings(["system","news"]);j.newsid=f;j.urid=UIDGenerator.get();var h=Mustache.render(i,j);e(".modal-body","#"+g).html(h)},onsubmitted:function(g,h){c()}})}function c(){document.location=e("base").attr("href")+"news"}return{showAdd:d,showEdit:a,showDelete:b,gotoList:c}})(jQuery);