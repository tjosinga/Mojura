var NewsView=function(e){"use strict";e(document).ready(function(){Locale.ensureLoaded("system");Locale.ensureLoaded("news")});function t(){n("new")}function n(t){Modal.create({id:"newsAddEditModal",modal_large:true,title:Locale.str("news","edit"),oncreated:function(n,o){e("#"+n).modal("show");var s="__api__/news/"+t;e.getJSON(s,function(s){var r=e("#template-news-addedit").html();s=e.extend({},s,Locale.getViewsStrings(["system","news"]));s.method=t==="new"?"post":"put";s.newsid=t;s.urid=UIDGenerator.get();s.simple_rights_visible=(s.rights.rights&4)>0;var a={"rights-controls":e("#template-rights-controls").html()};var d=Mustache.render(r,s,a);e(".modal-body","#"+n).html(d);o()});return true},onsubmitted:function(e,t){location.reload()}})}function o(t){Modal.create({id:"newsDeleteModal",btn_class:"btn-danger",btn_action:Locale.str("system","delete"),title:Locale.str("news","delete"),oncreated:function(n){e("#"+n).modal("show");var o=e("#template-news-delete").html();var s=Locale.getViewsStrings(["system","news"]);s.newsid=t;s.urid=UIDGenerator.get();var r=Mustache.render(o,s);e(".modal-body","#"+n).html(r)},onsubmitted:function(e,t){s()}})}function s(){document.location=e("base").attr("href")+"news"}return{showAdd:t,showEdit:n,showDelete:o,gotoList:s}}(jQuery);