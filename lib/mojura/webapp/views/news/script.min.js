var NewsView=function(e){"use strict";e(document).ready(function(){Locale.ensureLoaded("system");Locale.ensureLoaded("news")});function t(){s("new")}function s(t){Modal.create({id:"newsAddEditModal",modal_large:true,title:Locale.str("news","edit"),oncreated:function(s,n){e("#"+s).modal("show");var o="__api__/news/"+t+"?include_settings=news.categories";e.getJSON(o,function(o){var r=e("#template-news-addedit").html();o=e.extend({},o,Locale.getViewsStrings(["system","news"]));o.method=t==="new"?"post":"put";o.newsid=t;var a=o.settings.news.categories;if(typeof a!=="null"||typeof a!=="undefined"){o.has_categories=true;if(typeof a==="string"){o.categories=a.split(",")}else{o.categories=a}for(var i in o.categories){o.categories[i]=o.categories[i].replace(/(^\s+|\s+$)/,"")}}o.urid=UIDGenerator.get();o.simple_rights_visible=(o.rights.rights&4)>0;var d={"rights-controls":e("#template-rights-controls").html()};var l=Mustache.render(r,o,d);e(".modal-body","#"+s).html(l);n()});return true},onsubmitted:function(e,t){location.reload()}})}function n(t){Modal.create({id:"newsDeleteModal",btn_class:"btn-danger",btn_action:Locale.str("system","delete"),title:Locale.str("news","delete"),oncreated:function(s){e("#"+s).modal("show");var n=e("#template-news-delete").html();var o=Locale.getViewsStrings(["system","news"]);o.newsid=t;o.urid=UIDGenerator.get();var r=Mustache.render(n,o);e(".modal-body","#"+s).html(r)},onsubmitted:function(e,t){o()}})}function o(){document.location=e("base").attr("href")+"news"}return{showAdd:t,showEdit:s,showDelete:n,gotoList:o}}(jQuery);